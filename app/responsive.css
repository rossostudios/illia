/* Advanced Responsive Design System with Container Queries */

/* Fluid Typography System */
:root {
  /* Fluid font sizes using clamp() */
  --fs-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
  --fs-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem);
  --fs-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
  --fs-lg: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
  --fs-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
  --fs-2xl: clamp(1.5rem, 1.3rem + 1vw, 1.875rem);
  --fs-3xl: clamp(1.875rem, 1.5rem + 1.875vw, 2.25rem);
  --fs-4xl: clamp(2.25rem, 1.8rem + 2.25vw, 3rem);
  --fs-5xl: clamp(3rem, 2.25rem + 3.75vw, 4rem);
  --fs-6xl: clamp(3.75rem, 2.75rem + 5vw, 5rem);

  /* Fluid spacing scale */
  --space-xs: clamp(0.25rem, 0.2rem + 0.25vw, 0.375rem);
  --space-sm: clamp(0.5rem, 0.4rem + 0.5vw, 0.75rem);
  --space-md: clamp(1rem, 0.8rem + 1vw, 1.5rem);
  --space-lg: clamp(1.5rem, 1.2rem + 1.5vw, 2rem);
  --space-xl: clamp(2rem, 1.5rem + 2.5vw, 3rem);
  --space-2xl: clamp(3rem, 2rem + 5vw, 5rem);
  --space-3xl: clamp(4rem, 3rem + 5vw, 6rem);

  /* Fluid line heights */
  --lh-tight: clamp(1.2, 1.15 + 0.25vw, 1.3);
  --lh-base: clamp(1.5, 1.45 + 0.25vw, 1.6);
  --lh-relaxed: clamp(1.75, 1.7 + 0.25vw, 1.8);

  /* Container widths */
  --container-xs: 100%;
  --container-sm: min(100%, 640px);
  --container-md: min(100%, 768px);
  --container-lg: min(100%, 1024px);
  --container-xl: min(100%, 1280px);
  --container-2xl: min(100%, 1536px);
}

/* Container Queries Support */
@supports (container-type: inline-size) {
  /* Container definitions */
  .container-responsive {
    container-type: inline-size;
  }

  .container-card {
    container-type: inline-size;
    container-name: card;
  }

  .container-sidebar {
    container-type: inline-size;
    container-name: sidebar;
  }

  .container-main {
    container-type: inline-size;
    container-name: main;
  }

  /* Container query responsive utilities */
  @container (min-width: 320px) {
    .cq\:text-sm {
      font-size: var(--fs-sm);
    }
    .cq\:p-2 {
      padding: var(--space-sm);
    }
    .cq\:grid-cols-1 {
      grid-template-columns: repeat(1, 1fr);
    }
  }

  @container (min-width: 480px) {
    .cq\:text-base {
      font-size: var(--fs-base);
    }
    .cq\:p-3 {
      padding: calc(var(--space-sm) * 1.5);
    }
    .cq\:grid-cols-2 {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @container (min-width: 640px) {
    .cq\:text-lg {
      font-size: var(--fs-lg);
    }
    .cq\:p-4 {
      padding: var(--space-md);
    }
    .cq\:grid-cols-3 {
      grid-template-columns: repeat(3, 1fr);
    }
    .cq\:flex-row {
      flex-direction: row;
    }
  }

  @container (min-width: 768px) {
    .cq\:text-xl {
      font-size: var(--fs-xl);
    }
    .cq\:p-6 {
      padding: var(--space-lg);
    }
    .cq\:grid-cols-4 {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* Named container queries */
  @container card (min-width: 300px) {
    .card-title {
      font-size: var(--fs-lg);
    }
    .card-body {
      padding: var(--space-md);
    }
    .card-actions {
      flex-direction: row;
    }
  }

  @container sidebar (max-width: 250px) {
    .sidebar-collapsed {
      .sidebar-label {
        display: none;
      }
      .sidebar-icon {
        margin: 0 auto;
      }
    }
  }

  @container main (min-width: 800px) {
    .content-wide {
      max-width: 100%;
      grid-template-columns: repeat(3, 1fr);
    }
  }
}

/* Fluid Typography Classes */
.text-fluid-xs {
  font-size: var(--fs-xs);
}
.text-fluid-sm {
  font-size: var(--fs-sm);
}
.text-fluid-base {
  font-size: var(--fs-base);
}
.text-fluid-lg {
  font-size: var(--fs-lg);
}
.text-fluid-xl {
  font-size: var(--fs-xl);
}
.text-fluid-2xl {
  font-size: var(--fs-2xl);
}
.text-fluid-3xl {
  font-size: var(--fs-3xl);
}
.text-fluid-4xl {
  font-size: var(--fs-4xl);
}
.text-fluid-5xl {
  font-size: var(--fs-5xl);
}
.text-fluid-6xl {
  font-size: var(--fs-6xl);
}

/* Fluid Spacing Classes */
.p-fluid-xs {
  padding: var(--space-xs);
}
.p-fluid-sm {
  padding: var(--space-sm);
}
.p-fluid-md {
  padding: var(--space-md);
}
.p-fluid-lg {
  padding: var(--space-lg);
}
.p-fluid-xl {
  padding: var(--space-xl);
}
.p-fluid-2xl {
  padding: var(--space-2xl);
}

.gap-fluid-xs {
  gap: var(--space-xs);
}
.gap-fluid-sm {
  gap: var(--space-sm);
}
.gap-fluid-md {
  gap: var(--space-md);
}
.gap-fluid-lg {
  gap: var(--space-lg);
}
.gap-fluid-xl {
  gap: var(--space-xl);
}

/* Responsive Grid with Container Queries */
.grid-responsive {
  display: grid;
  gap: var(--space-md);
  grid-template-columns: repeat(auto-fit, minmax(min(100%, 250px), 1fr));
}

/* Container query based grid */
@supports (container-type: inline-size) {
  .grid-container-aware {
    container-type: inline-size;
  }

  @container (min-width: 320px) {
    .grid-container-aware > .grid-auto {
      grid-template-columns: 1fr;
    }
  }

  @container (min-width: 640px) {
    .grid-container-aware > .grid-auto {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @container (min-width: 1024px) {
    .grid-container-aware > .grid-auto {
      grid-template-columns: repeat(3, 1fr);
    }
  }
}

/* Aspect Ratio Containers */
.aspect-square {
  aspect-ratio: 1 / 1;
}
.aspect-video {
  aspect-ratio: 16 / 9;
}
.aspect-portrait {
  aspect-ratio: 3 / 4;
}
.aspect-landscape {
  aspect-ratio: 4 / 3;
}
.aspect-ultrawide {
  aspect-ratio: 21 / 9;
}
.aspect-golden {
  aspect-ratio: 1.618 / 1;
}

/* Responsive aspect ratios */
@media (max-width: 640px) {
  .aspect-mobile-square {
    aspect-ratio: 1 / 1;
  }
  .aspect-mobile-portrait {
    aspect-ratio: 3 / 4;
  }
}

/* Modern Responsive Utilities */
.responsive-hide-mobile {
  @media (max-width: 767px) {
    display: none;
  }
}

.responsive-hide-tablet {
  @media (min-width: 768px) and (max-width: 1023px) {
    display: none;
  }
}

.responsive-hide-desktop {
  @media (min-width: 1024px) {
    display: none;
  }
}

/* Responsive Text Alignment */
.text-responsive {
  text-align: center;

  @media (min-width: 640px) {
    text-align: left;
  }

  @media (min-width: 1024px) {
    text-align: justify;
  }
}

/* Modern Layout Patterns */
.sidebar-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--space-lg);

  @media (min-width: 768px) {
    grid-template-columns: 250px 1fr;
  }

  @media (min-width: 1280px) {
    grid-template-columns: 300px 1fr;
  }
}

.holy-grail {
  display: grid;
  grid-template-areas:
    "header"
    "main"
    "footer";
  min-height: 100vh;

  @media (min-width: 768px) {
    grid-template-areas:
      "header header header"
      "nav main aside"
      "footer footer footer";
    grid-template-columns: 200px 1fr 200px;
    grid-template-rows: auto 1fr auto;
  }
}

/* Responsive Flexbox Utilities */
.flex-responsive {
  display: flex;
  flex-direction: column;
  gap: var(--space-md);

  @media (min-width: 640px) {
    flex-direction: row;
    flex-wrap: wrap;
  }

  @media (min-width: 1024px) {
    flex-wrap: nowrap;
  }
}

/* Smart Grid with auto-fit */
.grid-auto-fit {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(var(--grid-min, 250px), 1fr));
  gap: var(--grid-gap, var(--space-md));
}

.grid-auto-fill {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--grid-min, 250px), 1fr));
  gap: var(--grid-gap, var(--space-md));
}

/* Responsive Card Grid */
.card-grid {
  display: grid;
  gap: var(--space-lg);
  grid-template-columns: 1fr;

  @media (min-width: 640px) {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (min-width: 1024px) {
    grid-template-columns: repeat(3, 1fr);
  }

  @media (min-width: 1536px) {
    grid-template-columns: repeat(4, 1fr);
  }
}

/* Responsive Tables */
.table-responsive {
  @media (max-width: 767px) {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    -webkit-overflow-scrolling: touch;
  }
}

.table-stack {
  @media (max-width: 640px) {
    display: block;

    thead {
      display: none;
    }

    tr {
      display: block;
      margin-bottom: var(--space-md);
      border: 1px solid var(--color-gray-200);
      border-radius: 8px;
      padding: var(--space-sm);
    }

    td {
      display: flex;
      justify-content: space-between;
      padding: var(--space-xs) 0;

      &::before {
        content: attr(data-label);
        font-weight: 600;
      }
    }
  }
}

/* Viewport Units with Fallbacks */
.h-screen-safe {
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
}

.min-h-screen-safe {
  min-height: 100vh;
  min-height: 100dvh;
}

.h-screen-small {
  height: 100vh;
  height: 100svh; /* Small viewport height */
}

.h-screen-large {
  height: 100vh;
  height: 100lvh; /* Large viewport height */
}

/* Performance Optimizations */
.will-change-responsive {
  @media (hover: hover) and (pointer: fine) {
    will-change: transform;
  }
}

.reduce-motion {
  @media (prefers-reduced-motion: reduce) {
    animation: none;
    transition: none;
  }
}

/* Print Styles */
@media print {
  .no-print {
    display: none;
  }
  .print-only {
    display: block;
  }
  .page-break {
    page-break-after: always;
  }
}
